<div id="particles-js">
  
  <div class="header">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet">

      <h1>
        <span class="site-title">{{site.user_title}} {{site.username}}</span>
        <span class="site-description">{{site.user_job_title}}</span>
      </h1>
      <div class="header-icons">
        <a aria-label="E-Mail" href="mailto:jonalbo311@gmail.com"><i class="icon fas fa-envelope"></i></a>
        <a rel="me" aria-label="LinkedIn" target="_blank" href="https://www.linkedin.com/in/jonalbo"><i class="icon fab fa-linkedin" aria-hidden="true"></i></a>
        </div>
      <div class="header-links">
        <a class="link" href="https://www.jonalbo.com/particle_site/#about">About</a>
        ·
        <a class="link" href="https://www.jonalbo.com/particle_site/#projects">Projects</a>
        ·
        <a class="link" href="https://www.jonalbo.com/JonAlbo_Resume.pdf">Resume</a>
        ·
        <a class="link" href="https://patents.google.com/?inventor=Jon+ALBO">Patents</a>
        ·
        <a class="link" href="https://scholar.google.com/citations?user=0ug4j68AAAAJ">Publications</a>
        ·
        <a class="link" href="https://www.jonalbo.com/particle_site/news">In the News</a>
        ·
        <a class="link" href="https://www.jonalbo.com/particle_site/photography">Photography</a>
      </div>
  </div>
  <a class="down" data-scroll><i class="icon fa fa-chevron-down" aria-hidden="true"></i></a>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const links = document.querySelectorAll('.header-links a');

  links.forEach(link => {
    const href = link.getAttribute('href');
    if (!href || !href.includes('#')) return;

    link.addEventListener('click', function(e) {
      const linkUrl = new URL(href, window.location.origin);
      const targetHash = linkUrl.hash.substring(1);
      const targetSection = document.getElementById(targetHash);

      // Normalize current page path
      const currentPath = window.location.pathname.replace(/\/$/, '');
      const isOnHomePage = currentPath === '/particle_site' || currentPath === '/particle_site/index.html';
      const isHomeLink = linkUrl.pathname.endsWith('/') || linkUrl.pathname.endsWith('/index.html');

      if (isHomeLink && isOnHomePage && targetSection) {
        // Already on homepage → scroll header first, then section
        e.preventDefault();

        const header = document.querySelector('.header');
        if (header) {
          header.scrollIntoView({ behavior: 'smooth' });
        }

        setTimeout(() => {
          targetSection.scrollIntoView({ behavior: 'smooth' });
          history.pushState(null, '', '#' + targetHash);
        }, 400); // adjust delay if needed
      }
      // else → navigate normally to homepage with hash
    });
  });

  // Down chevron scroll
  const downChevron = document.querySelector('.down');
  if (downChevron) {
    downChevron.addEventListener('click', function(e) {
      e.preventDefault();
      const firstSection = document.querySelector('section');
      if (firstSection) firstSection.scrollIntoView({ behavior: 'smooth' });
    });
  }

  // Handle smooth scroll on page load with hash (from other pages)
  if (window.location.hash) {
    const targetId = window.location.hash.substring(1);
    const target = document.getElementById(targetId);
    if (target) {
      const header = document.querySelector('.header');
      if (header) {
        header.scrollIntoView({ behavior: 'smooth' });
      }

      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth' });
      }, 400);
    }
  }
});
</script>
